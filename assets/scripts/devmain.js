const skeletonPage=' <section class="loader-container">\n    \n    \n    <div class="loading-text">\n      Loading<i>.</i><i>.</i><i>.</i>\n    </div>\n    \n    \n    <div class="subtitle">Preparing your experience</div>\n    \n    \x3c!-- Product skeleton cards --\x3e\n    <div class="skeleton-preview">\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b>\n        <div class="skeleton-line"></div>\n      </div>\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b>\n        <div class="skeleton-line"></div>\n      </div>\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b>\n        <div class="skeleton-line"></div>\n      </div>\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b>\n        <div class="skeleton-line"></div>\n      </div>\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b>\n        <div class="skeleton-line"></div>\n      </div>\n      <div class="skeleton-card">\n        <div class="skeleton-img"></div>\n        <div class="skeleton-line"></div>\n        <b class="skeleton-line"></b><div class="skeleton-line"></div>\n      </div>\n      \n    </div>\n  </section>';import{createClient}from"https://esm.sh/@supabase/supabase-js@2";function formatCount(e){return e>=1e9?(e/1e9).toFixed(1).replace(/\.0$/,"")+"B":e>=1e6?(e/1e6).toFixed(1).replace(/\.0$/,"")+"M":e>=1e3?(e/1e3).toFixed(1).replace(/\.0$/,"")+"K":e.toString()}function formatLength(e){const t=100-e.length;return t>=4?e+="<i style='color:transparent !important;'>- </i>".repeat(t):e}async function initFor(){document.querySelectorAll(".buttons").forEach((e=>{const t=e.querySelector(".sales"),n=parseInt(t.textContent);t.textContent=formatCount(n),t.dataset.rawCount=n;const r=e.querySelector(".star-count"),o=parseInt(r.textContent);r.dataset.rawCount=o,r.textContent=formatCount(o)}))}const{url:url,key:key}={url:td,key:tc},suggestMap=["build with javascript","image format","images pack","web asset","python script","template design","format text","with js","React App","svg pack","Ai automation","graphics design","digital design","portfolio website","blog page","vendors split","one page","SEO friendly","blog template","react template","modern design","modern animation","php script","css and",`${(new Date).getFullYear()}`,"Next.js tutorial","TypeScript guide","Vue.js components","API integration","mobile responsive","PWA development","web performance","SEO optimization","GitHub repository","npm packages","REST API","with GraphQL","web3 development","blockchain integration","AI API integration","ChatGPT plugins","AI content generation","automated marketing","AI image generator","Midjourney prompts","Stable Diffusion","AI chatbot","machine learning","Python automation scripts","no-code automation","Zapier integration","Make.com automation","content marketing strategy","social media marketing","SEO techniques","Google Analytics","email marketing automation","conversion optimization","landing page design","lead generation","affiliate marketing","influencer marketing","video marketing","TikTok ads","Instagram Reels","LinkedIn B2B marketing","Shopify theme","WooCommerce plugins","dropshipping automation","e-commerce SEO","payment gateway","cart abandonment","customer retention","sales funnel","CRM integration","business analytics","UI/UX design","Figma templates","design system","responsive design","dark mode design"," micro-interactions","3D web design"," glassmorphism","brutalism design","minimalist design","typography trends","color palette generator","blog SEO optimization","content calendar","keyword research","long-form content","video blogging","podcast setup","newsletter design","content repurposing","guest posting","blog monetization","social media scheduler","content creation tools","community management","growth hacking","viral content strategy","engagement tactics","social media analytics","brand building","personal branding","core web vitals","page speed optimization","structured data","schema markup","local SEO","technical SEO audit","mobile-first indexing","backlink strategy","AR/VR development","metaverse marketing","voice search optimization","progressive web apps","IoT integration","chatbot development","voice assistant skills","data visualization","Google Data Studio","marketing analytics","A/B testing tools","heatmap analysis","user behavior tracking","ROI measurement","productivity automation","project management tools","collaboration software","design collaboration","remote work tools","time management apps","SaaS marketing","agency website templates","freelancer portfolio","startup landing page","nonprofit website","education platform","healthcare website","real estate marketing"];function suggestHighlight(e){e.toLowerCase();let t=e;return suggestMap.forEach((e=>{e.toLowerCase().split(",").forEach((e=>{const n=new RegExp(`\\b${e}\\b`,"i");t=t.replace(n,(e=>`<a href='#search?q=${encodeURIComponent(e)}'>${e}<sup><svg xmlns="http://www.w3.org/2000/svg" \n     width="8" height="8" \n     viewBox="0 0 24 24" \n     fill="none" stroke="currentColor" \n     stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n  <circle cx="11" cy="11" r="8" />\n  <line x1="21" y1="21" x2="16.65" y2="16.65" />\n</svg></sup></a>`))}))})),t}export const supabase=createClient(url,key);async function getUser(){const{data:e,error:t}=await supabase.auth.getUser();return t?(console.error("Auth error:",t),null):e?.user||null}async function toggleStar(e,t,n){const r=await getUser();if(!r)return void cAlert("Please log in to star posts.","warning","User Author");const o=r.id;try{const{data:r,error:s}=await supabase.from("stars").select("id").eq("user_id",o).eq("post_id",e).maybeSingle();if(s)throw s;r?(await supabase.from("stars").delete().eq("id",r.id),t.style.color="#ddd"):(await supabase.from("stars").insert({user_id:o,post_id:e}),t.style.color="red");const{count:i,error:a}=await supabase.from("stars").select("*",{count:"exact",head:!0}).eq("post_id",e);if(a)throw a;n.dataset.stareds=i,n.textContent=formatCount(i)}catch(e){console.error("Star toggle failed:",e),cAlert("Could not update like, try again.","warning","not added")}}async function initStar(e,t,n){const r=await getUser();t.style.color="#ddd";try{const{count:o,error:s}=await supabase.from("stars").select("*",{count:"exact",head:!0}).eq("post_id",e);if(s)throw s;if(n.dataset.stareds=o,n.textContent=formatCount(o),r){const n=r.id,{data:o,error:s}=await supabase.from("stars").select("id").eq("user_id",n).eq("post_id",e).maybeSingle();if(s)throw s;o&&(t.style.color="red")}}catch(e){console.error("Star init failed:",e)}}window.fn=function(e){return e.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})};const rewId=new URLSearchParams(window.location.search).get("rew")||"419c4e51-d5cf-4ac5-a765-a19576642f51",cart=[],cartBox=document.querySelector(".cart-items"),cartTotalEl=cartBox.querySelector("h4 span");let checkoutBtn=document.createElement("button");checkoutBtn.textContent="Checkout with Paystack",checkoutBtn.className="checkout-btn",checkoutBtn.style.cssText="\n  background: #0a6;\n  color: #fff;\n  border: none;\n  padding: 8px 14px;\n  margin-top: 5px;\n  border-radius: 5px;\n  cursor: pointer;\n";let inform=document.createElement("div");function updateCartUI(){cartBox.querySelectorAll(".cart-item").forEach((e=>e.remove()));let e=0;cart.forEach(((t,n)=>{e+=t.price;const r=document.createElement("div");r.className="cart-item",r.innerHTML=`\n      <strong>${t.title}</strong> [ â‚¦${fn(t.price)}]\n      <button data-index="${n}" class="remove">x</button>`,cartBox.insertBefore(r,cartBox.querySelector("h4"))})),cartTotalEl.textContent=fn(e),cart.length>0?cartBox.contains(inform)||cartBox.appendChild(inform):cartBox.contains(inform)&&inform.remove(),cart.length>0?cartBox.contains(checkoutBtn)||cartBox.appendChild(checkoutBtn):cartBox.contains(checkoutBtn)&&checkoutBtn.remove(),cartBox.querySelectorAll(".remove").forEach((e=>{e.onclick=e=>{const t=e.target.dataset.index;cart.splice(t,1),updateCartUI()}}))}function resetCheckoutButton(e,t){e.disabled=!1,e.textContent=t}async function handlePaymentVerification(e){try{console.log("Verifying payment with reference:",e);const t=await fetch("/.netlify/functions/verify-pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reference:e,rewId:rewId})}),n=await t.json();console.log("Verification response:",n),n.success?(cAlert("Payment successful! Your downloads are ready.","success","Success"),cart.length=0,updateCartUI(),showDownloadLinks(n.downloadLinks)):cAlert("Payment verification failed: "+(n.error||"Unknown error"),"warning","initial error")}catch(t){console.error("Verification error:",t),cAlert("Could not verify payment. Please contact support with reference: "+e,"warning","initial error")}}function showDownloadLinks(e){const t=cartBox.querySelector(".download-links");t&&t.remove();const n=document.createElement("div");n.className="download-links",n.style.cssText="\n    margin-top: 15px;\n    padding: 15px;\n    border: 2px solid #0a6;\n    border-radius: 8px;\n    background: #f9fff9;\n  ";const r=document.createElement("h4");r.textContent="ðŸ“¥ Your Downloads",r.style.cssText="margin-bottom: 10px; color: #0a6;",n.appendChild(r);const o=document.createElement("p");o.textContent="Links are valid for 24 hours. Click to download:",o.style.cssText="font-size: 14px; color: #666; margin-bottom: 10px;",n.appendChild(o),e.forEach((e=>{const t=document.createElement("div");t.style.cssText="margin: 8px 0; padding: 8px; background: white; border-radius: 4px;";const r=document.createElement("a");r.href=e.url,r.textContent=`Download: ${e.title||"Item "+e.id}`,r.target="_blank",r.style.cssText="\n      display: block;\n      padding: 8px 12px;\n      background: #0a6;\n      color: white;\n      text-decoration: none;\n      border-radius: 4px;\n      text-align: center;\n      font-weight: bold;\n    ",r.onmouseover=()=>r.style.background="#084",r.onmouseout=()=>r.style.background="#0a6",t.appendChild(r),n.appendChild(t),n.innerHTML+='<button onclick="this.parentElement.style.display=\'none\'"><I class="fas fa-times"></i> close</button>'})),cartBox.appendChild(n)}async function verifyPaymentOnReturn(e){try{const t=await fetch("/.netlify/functions/verify-pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reference:e})}),n=await t.json();n.success?(cAlert("â˜‘ Payment verified! Your downloads are ready.","warning","Verified"),showDownloadLinks(n.downloadLinks),cart.length=0,updateCartUI(),window.history.replaceState({},document.title,window.location.pathname)):cAlert("Payment verification failed: "+n.error,"warning","initial error")}catch(e){console.error("Verification error:",e),cAlert("Could not verify payment. Please contact support.","error","Unknown error")}}async function loadPosts(e="id",t=!1){try{const n=await getUser();if(!n)return console.warn("No logged-in user found."),void(document.querySelector(".product").innerHTML=`\n        <div class="card">\n          <div class="product-img" style="background-image: url(https://media.tenor.com/2yKn3g52FdgAAAAM/login-required-access-denied-gen-v.gif);">\n            <h3><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xml:space="preserve" width="24" height="24" viewBox="0 0 256 256" fill="currentColor">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 72.975 58.994 H 31.855 c -1.539 0 -2.897 -1.005 -3.347 -2.477 L 15.199 13.006 H 3.5 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 h 14.289 c 1.539 0 2.897 1.005 3.347 2.476 l 13.309 43.512 h 36.204 l 10.585 -25.191 h -6.021 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 H 86.5 c 1.172 0 2.267 0.587 2.915 1.563 s 0.766 2.212 0.312 3.293 L 76.201 56.85 C 75.655 58.149 74.384 58.994 72.975 58.994 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<circle cx="28.88" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<circle cx="74.59" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<path d="M 62.278 19.546 H 52.237 V 9.506 c 0 -1.933 -1.567 -3.5 -3.5 -3.5 s -3.5 1.567 -3.5 3.5 v 10.04 h -10.04 c -1.933 0 -3.5 1.567 -3.5 3.5 s 1.567 3.5 3.5 3.5 h 10.04 v 10.04 c 0 1.933 1.567 3.5 3.5 3.5 s 3.5 -1.567 3.5 -3.5 v -10.04 h 10.041 c 1.933 0 3.5 -1.567 3.5 -3.5 S 64.211 19.546 62.278 19.546 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n</g>\n</svg></h3>\n            <h4 data-view="https://media.tenor.com/J3_7mEynzQIAAAAM/ganz.gif"><svg width="24" height="20" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>\n      </svg></h4>\n          </div>\n          <p class="product-describe">\n            <strong><a href="/signup.html">Sign up/Login</a></strong><br>\n              Find useful digital products, explore creator work, and connect easilyâ€”all in one place.\n          </p>\n          <input type="button" class="learn-more" value="Sign up / Login" onclick="window.location.href=('/signup')"/>\n\n          <div class="profile" data-name="@DevTemple_auth" data-bio="Official DevTemple â€¢">\n         <div class="prof-row">\n      <img src="/assets/images/20250918_223801.png" alt="DevTemple profile" loading="lazy">\n      <div class="p-flex">\n        <div><strong class="user-name">Auth </strong>\n      <span><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="12" height="12" viewBox="0 0 256 256" xml:space="preserve">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 49.66 1.125 L 49.66 1.125 c 4.67 -2.393 10.394 -0.859 13.243 3.548 l 0 0 c 1.784 2.761 4.788 4.495 8.071 4.66 l 0 0 c 5.241 0.263 9.431 4.453 9.694 9.694 v 0 c 0.165 3.283 1.899 6.286 4.66 8.071 l 0 0 c 4.407 2.848 5.941 8.572 3.548 13.242 l 0 0 c -1.499 2.926 -1.499 6.394 0 9.319 l 0 0 c 2.393 4.67 0.859 10.394 -3.548 13.242 l 0 0 c -2.761 1.784 -4.495 4.788 -4.66 8.071 v 0 c -0.263 5.241 -4.453 9.431 -9.694 9.694 h 0 c -3.283 0.165 -6.286 1.899 -8.071 4.66 l 0 0 c -2.848 4.407 -8.572 5.941 -13.242 3.548 l 0 0 c -2.926 -1.499 -6.394 -1.499 -9.319 0 l 0 0 c -4.67 2.393 -10.394 0.859 -13.242 -3.548 l 0 0 c -1.784 -2.761 -4.788 -4.495 -8.071 -4.66 h 0 c -5.241 -0.263 -9.431 -4.453 -9.694 -9.694 l 0 0 c -0.165 -3.283 -1.899 -6.286 -4.66 -8.071 l 0 0 C 0.266 60.054 -1.267 54.33 1.125 49.66 l 0 0 c 1.499 -2.926 1.499 -6.394 0 -9.319 l 0 0 c -2.393 -4.67 -0.859 -10.394 3.548 -13.242 l 0 0 c 2.761 -1.784 4.495 -4.788 4.66 -8.071 l 0 0 c 0.263 -5.241 4.453 -9.431 9.694 -9.694 l 0 0 c 3.283 -0.165 6.286 -1.899 8.071 -4.66 l 0 0 c 2.848 -4.407 8.572 -5.941 13.242 -3.548 l 0 0 C 43.266 2.624 46.734 2.624 49.66 1.125 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: var(--primary-color); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<polygon points="36.94,66.3 36.94,66.3 36.94,46.9 36.94,46.9 62.8,35.34 72.5,45.04 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: var(--primary-color); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<polygon points="36.94,66.3 17.5,46.87 27.2,37.16 36.94,46.9 60.11,23.7 69.81,33.39 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n</g>\n</svg>\n      </span>\n      &nbsp;<sup class="report" style="color:#f50;">Report</sup></div>\n      <div class="handle">\n      <small style="font-size: 13px;color: var(--text-dim);">@auth</small>\n      </div>\n      </div>\n    </div>\n          </div>\n          \n  <div class="buttons">\n    <span class="star-contain">\n      <button class="star" data-post-id="123abc" style="cursor: pointer; background: none; border: none; color: inherit;">\n        <svg width="23" height="23" viewBox="0 0 24 24" fill="currentColor">\n          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n        </svg></button><span class="star-count" data-raw-count="0">${formatCount(190986)}</span>\n    </span>\n    <span class="amount" data-price="0"><span>â‚¦${fn(0)} </span><small><i><b class="sales">${formatCount(0)}</b> sold</i></small>\n    </span>\n    <a name="${encodeURIComponent("")}" class="">\n      <span class="star-contain share-icon">\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n          <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>\n        </svg>\n      </span>\n    </a>\n          <span class="star-contain cart-icon" onclick="window.location.href=('/signup')">\n       <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xml:space="preserve" width="20" height="20" viewBox="0 0 256 256" fill="currentColor">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 72.975 58.994 H 31.855 c -1.539 0 -2.897 -1.005 -3.347 -2.477 L 15.199 13.006 H 3.5 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 h 14.289 c 1.539 0 2.897 1.005 3.347 2.476 l 13.309 43.512 h 36.204 l 10.585 -25.191 h -6.021 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 H 86.5 c 1.172 0 2.267 0.587 2.915 1.563 s 0.766 2.212 0.312 3.293 L 76.201 56.85 C 75.655 58.149 74.384 58.994 72.975 58.994 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<circle cx="28.88" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<circle cx="74.59" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<path d="M 62.278 19.546 H 52.237 V 9.506 c 0 -1.933 -1.567 -3.5 -3.5 -3.5 s -3.5 1.567 -3.5 3.5 v 10.04 h -10.04 c -1.933 0 -3.5 1.567 -3.5 3.5 s 1.567 3.5 3.5 3.5 h 10.04 v 10.04 c 0 1.933 1.567 3.5 3.5 3.5 s 3.5 -1.567 3.5 -3.5 v -10.04 h 10.041 c 1.933 0 3.5 -1.567 3.5 -3.5 S 64.211 19.546 62.278 19.546 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n</g>\n</svg>\n      </span>\n  </div>\n      `);const{data:r,error:o}=await supabase.from("posts").select("id, name, description, price, cover, star, sales, file_path, viewer, user_id, portfolio_url, sponsored, created_at").order(e,{ascending:t});if(o)throw o;const s=document.querySelector(".product");if(s.innerHTML='  <div class="loading-post">\n    <button>\n      \n    </button><span>Loading...</span>\n    <style>\n\n    </style>\n  </div>',!r||0===r.length)return void(s.innerHTML='<p class="empty-msg">You haven\'t uploaded any posts yet.</p>');const i=[...new Set(r.map((e=>e.user_id)))],{data:a,error:l}=await supabase.from("profiles").select("id, username, full_name, photo_url, bio, skills, status").in("id",i);l&&console.error("Error fetching profiles:",l);const c=new Map(a?.map((e=>[e.id,e]))||[]);s.innerHTML="",r.forEach((e=>{const t=c.get(e.user_id)||{},r=document.createElement("div");r.className="card",r.dataset.id=e.id,r.dataset.filePath=e.file_path,r.dataset.sellerId=e.user_id,r.dataset.profileId=e.user_id,r.innerHTML=`\n      <button class="sub-menu-btn" onclick="this.parentElement.querySelector('.card-menu').style.display='block'; ">â€¦</button>\n  <div class="product-img" style="background-image: url(${e.cover||"/assets/images/index.png"});">\n    <h3 style="visibility:${"n"!==e.sponsored?"hidden":"visible"};pointer-events:${n.id===e.user_id?"none":""};"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xml:space="preserve" width="24" height="24" viewBox="0 0 256 256" fill="currentColor">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 72.975 58.994 H 31.855 c -1.539 0 -2.897 -1.005 -3.347 -2.477 L 15.199 13.006 H 3.5 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 h 14.289 c 1.539 0 2.897 1.005 3.347 2.476 l 13.309 43.512 h 36.204 l 10.585 -25.191 h -6.021 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 H 86.5 c 1.172 0 2.267 0.587 2.915 1.563 s 0.766 2.212 0.312 3.293 L 76.201 56.85 C 75.655 58.149 74.384 58.994 72.975 58.994 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<circle cx="28.88" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<circle cx="74.59" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<path d="M 62.278 19.546 H 52.237 V 9.506 c 0 -1.933 -1.567 -3.5 -3.5 -3.5 s -3.5 1.567 -3.5 3.5 v 10.04 h -10.04 c -1.933 0 -3.5 1.567 -3.5 3.5 s 1.567 3.5 3.5 3.5 h 10.04 v 10.04 c 0 1.933 1.567 3.5 3.5 3.5 s 3.5 -1.567 3.5 -3.5 v -10.04 h 10.041 c 1.933 0 3.5 -1.567 3.5 -3.5 S 64.211 19.546 62.278 19.546 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n</g>\n</svg></h3>\n    <h4 data-view="${e.viewer||"https://media.tenor.com/rRBWXoBqPikAAAAM/critical-error-error.gif"}" class="${"n"!==e.sponsored?"ad":""}" ${"n"!==e.sponsored?"onclick='null'":""}>${"n"!==e.sponsored?"AD":'<svg width="24" height="20" viewBox="0 0 24 24" fill="currentColor">\n        <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>\n      </svg>'}</h4>\n  </div>\n  <p class="product-describe" onclick="this.parentElement.querySelector('.sub-menu-btn').click()">\n    <strong>${e.name?.slice(0,30).replace(/</g,"&lt;").replace(/>/g,"&gt;")}${e.name.length>30?"â€¦":""}  </strong><br>\n    ${formatLength(e.description?.slice(0,100).replace(/</g,"&lt;").replace(/>/g,"&gt;"))}${e.description.length>100?"â€¦":""}\n  </p>\n  <input type="${"n"!==e.sponsored?"button":"hidden"}" class="learn-more" value="Learn more" onclick="window.location.href=('${e.sponsored}')"/>\n  <div class="profile" data-bio="${t.bio||""} â€¢ ${t.skills||""}" name="${encodeURIComponent(e.name)}">\n    <div class="prof-row">\n      <img src="${t.photo_url||e.cover||"/assets/images/default.png"}" alt="User profile" loading="lazy">\n      <div class="p-flex">\n        <div><strong class="user-name">${t.full_name||e.name?.slice(0,10).replace(/</g,"&lt;").replace(/>/g,"&gt;")||" "}</strong>\n      <span>${"verified"===t.status?'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="12" height="12" viewBox="0 0 256 256" xml:space="preserve">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 49.66 1.125 L 49.66 1.125 c 4.67 -2.393 10.394 -0.859 13.243 3.548 l 0 0 c 1.784 2.761 4.788 4.495 8.071 4.66 l 0 0 c 5.241 0.263 9.431 4.453 9.694 9.694 v 0 c 0.165 3.283 1.899 6.286 4.66 8.071 l 0 0 c 4.407 2.848 5.941 8.572 3.548 13.242 l 0 0 c -1.499 2.926 -1.499 6.394 0 9.319 l 0 0 c 2.393 4.67 0.859 10.394 -3.548 13.242 l 0 0 c -2.761 1.784 -4.495 4.788 -4.66 8.071 v 0 c -0.263 5.241 -4.453 9.431 -9.694 9.694 h 0 c -3.283 0.165 -6.286 1.899 -8.071 4.66 l 0 0 c -2.848 4.407 -8.572 5.941 -13.242 3.548 l 0 0 c -2.926 -1.499 -6.394 -1.499 -9.319 0 l 0 0 c -4.67 2.393 -10.394 0.859 -13.242 -3.548 l 0 0 c -1.784 -2.761 -4.788 -4.495 -8.071 -4.66 h 0 c -5.241 -0.263 -9.431 -4.453 -9.694 -9.694 l 0 0 c -0.165 -3.283 -1.899 -6.286 -4.66 -8.071 l 0 0 C 0.266 60.054 -1.267 54.33 1.125 49.66 l 0 0 c 1.499 -2.926 1.499 -6.394 0 -9.319 l 0 0 c -2.393 -4.67 -0.859 -10.394 3.548 -13.242 l 0 0 c 2.761 -1.784 4.495 -4.788 4.66 -8.071 l 0 0 c 0.263 -5.241 4.453 -9.431 9.694 -9.694 l 0 0 c 3.283 -0.165 6.286 -1.899 8.071 -4.66 l 0 0 c 2.848 -4.407 8.572 -5.941 13.242 -3.548 l 0 0 C 43.266 2.624 46.734 2.624 49.66 1.125 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: var(--primary-color); fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<polygon points="36.94,66.3 36.94,66.3 36.94,46.9 36.94,46.9 62.8,35.34 72.5,45.04 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: var(--primary-color); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<polygon points="36.94,66.3 17.5,46.87 27.2,37.16 36.94,46.9 60.11,23.7 69.81,33.39 " style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(255,255,255); fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n</g>\n</svg>':""}\n      </span>\n      &nbsp;<sup class="report" style="color:#f50;">Report</sup></div>\n      <div class="handle">\n      <small style="font-size: 13px;color: var(--text-dim);">@${t.username||""}</small>\n      </div>\n      </div>\n    </div>\n  </div>\n  <div class="buttons">\n    <span class="star-contain">\n      <button class="star" data-post-id="${e.id}" style="cursor: pointer; background: none; border: none; color: inherit;">\n        <svg width="23" height="23" viewBox="0 0 24 24" fill="currentColor">\n          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n        </svg></button><span class="star-count" data-raw-count="${e.star||0}" data-stareds="0">\n        ${formatCount(e.star||0)}\n      </span>\n    </span>\n    <span class="amount" data-price="${e.price||0}" style="visibility:${"n"!==e.sponsored?"hidden":"visible"}"><span>â‚¦${fn(e.price||0)} </span><small><i><b class="sales">${formatCount(e.sales||0)}</b> sold</i></small>\n    </span>\n    <a name="${encodeURIComponent(e.description?.slice(0,200).replace(/\&amp\;/,"&").replace(/&gt;/,">").replace(/&lt;/,"<")||"")}" class="">\n      <span class="star-contain share-icon">\n        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">\n          <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>\n        </svg>\n      </span>\n    </a>\n          <span class="star-contain cart-icon" onclick="${"n"==e.sponsored?"this.parentElement.parentElement?.querySelector('.product-img h3').onclick()":`window.location.href=('${e.sponsored}')`}" style="pointer-events:${n.id===e.user_id?"none":""};">\n       <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xml:space="preserve" width="20" height="20" viewBox="0 0 256 256" fill="currentColor">\n<g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;" transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">\n\t<path d="M 72.975 58.994 H 31.855 c -1.539 0 -2.897 -1.005 -3.347 -2.477 L 15.199 13.006 H 3.5 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 h 14.289 c 1.539 0 2.897 1.005 3.347 2.476 l 13.309 43.512 h 36.204 l 10.585 -25.191 h -6.021 c -1.933 0 -3.5 -1.567 -3.5 -3.5 s 1.567 -3.5 3.5 -3.5 H 86.5 c 1.172 0 2.267 0.587 2.915 1.563 s 0.766 2.212 0.312 3.293 L 76.201 56.85 C 75.655 58.149 74.384 58.994 72.975 58.994 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n\t<circle cx="28.88" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<circle cx="74.59" cy="74.33" r="6.16" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform="  matrix(1 0 0 1 0 0) "/>\n\t<path d="M 62.278 19.546 H 52.237 V 9.506 c 0 -1.933 -1.567 -3.5 -3.5 -3.5 s -3.5 1.567 -3.5 3.5 v 10.04 h -10.04 c -1.933 0 -3.5 1.567 -3.5 3.5 s 1.567 3.5 3.5 3.5 h 10.04 v 10.04 c 0 1.933 1.567 3.5 3.5 3.5 s 3.5 -1.567 3.5 -3.5 v -10.04 h 10.041 c 1.933 0 3.5 -1.567 3.5 -3.5 S 64.211 19.546 62.278 19.546 z" style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: currentColor; fill-rule: nonzero; opacity: 1;" transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>\n</g>\n</svg>\n      </span>\n  </div>\n  <p style="max-height: 0 !important;position: absolute;z-index: -1;color: transparent !important;overflow: hidden;" class="search-index">${e.description?.replace(/</g,"&lt;").replace(/>/g,"&gt;")}\n   </p> \n   <div class="card-menu">\n           <button class="card-hide" onclick="this.parentElement.style.display='none'">&times;</button>\n      <p class="card-details">\n        <strong>${e.name?.replace(/</g,"&lt;").replace(/>/g,"&gt;")}  <sup><time>${"n"==e.sponsored?`${new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`:"sponsored"}</time></sup></strong>\n        <br>\n          ${e.description?.replace(/</g,"&lt;").replace(/>/g,"&gt;")}\n        </p>\n      <p class="card-rates">\n      </p>\n\n      <p class="card-btns">\n        <button class="add-to-cart" onclick="${"n"==e.sponsored?"this.parentElement.parentElement.parentElement.querySelector('.product-img h3').click()":`window.location.href='${e.sponsored}'`}" style="pointer-events:${n.id===e.user_id?"none":""};">${"n"!==e.sponsored?"View":"Add to cart"}</button>\n        <button class="report-card" onclick="this.parentElement.parentElement.parentElement.querySelector('.product-img h4').click()">Images</button>\n        <button class="copy-link" onclick="this.parentElement.parentElement.parentElement.querySelector('.buttons a').click()">Copy link</button>\n      </p>\n       <p class="card-rates">\n      </p>\n            <p class="card-btns">\n<span style="color: #aaaaaa; font-size: 14px;">\n  Get 7% from every sale made using your link:\n</span>\n        <button class="resell-btn copy-link" onclick="navigator.clipboard.writeText(this.name);cAlert('link copied', 'success', 'Ref');" name="https://devtem.org/home?rew=${n.id}#search?q=${encodeURIComponent(e.description?.slice(0,200).replace(/\&amp\;/,"&").replace(/&gt;/,">").replace(/&lt;/,"<")||"")}">Copy reward link</button>\n      </p>\n      <p class="card-rates"></p>\n      \n      <div style="border: 1px solid var(--glass-border, #ddd); padding: 16px; border-radius: 8px;">\n  <h4 style="margin-top: 0;">DevTemple License Summary</h4>\n  <ul style="list-style: none; padding: 0; font-size: 14px;">\n    <li style="margin-bottom: 8px;">&#x2714; Use for personal or commercial projects</li>\n    <li style="margin-bottom: 8px;">&#x2714; Modify and "remix" the code/assets</li>\n    <li style="margin-bottom: 8px;">&#x2714; Use for client work</li>\n    <hr style="border: 0; border-top: 1px solid #eee;">\n    <li style="margin-bottom: 8px;">&#x2715; Resell or redistribute the source files</li>\n    <li style="margin-bottom: 8px;">&#x2715; Claim the original work as your own</li>\n    <li style="margin-bottom: 8px;">&#x2715; Use in "site builders" where users extract files</li>\n  </ul>\n  <p style="font-size: 12px; color: #666;">Full license: <a href="/terms#general-license">devtem.org/terms</a></p>\n</div>\n    </div>\n`,s.appendChild(r);const o=r.querySelector("button.star"),i=r.querySelector(".star-count");r.querySelector(".star-contain").addEventListener("click",(()=>{toggleStar(e.id,o,i)})),r.addEventListener("dblclick",(()=>{toggleStar(e.id,o,i)})),initStar(e.id,o,i)}));const d=document.querySelector(".product");d.querySelectorAll(".card").forEach((e=>{const t=e.querySelector(".product-describe"),n=e.querySelector(".card-details");e&&(e.querySelector(".buttons a").addEventListener("click",(t=>{navigator.clipboard.writeText(`https://devtem.org/home.html#search?q=${e.querySelector(".buttons a").name?.slice(0,70)||""}`),cAlert("Link copied!","success","Copied")})),t.innerHTML=t.innerHTML.replace(/\#([\w\-]+)/g,"<a href='#search?q=$1' class='card-tag'>#$1</a>"),t.querySelectorAll(".card-tag").forEach((e=>{e.style.cssText='color: var(--primary-color);\n            font-family: "ADLaM Display", monospace;\n            text-decoration: none;cursor: pointer;'})),n.innerHTML=n.innerHTML.replace(/\#([\w\-]+)/g,"<a href='#search?q=$1' class='card-tag'>#$1</a>").replace(/\@([^\s\@]{3,})/g,"<span class='user-mention'>@$1</span>"),n.innerHTML=suggestHighlight(n.innerHTML),n.querySelectorAll(".card-tag").forEach((e=>{e.style.cssText='color: var(--primary-color);\n            font-family: "ADLaM Display", monospace;\n            text-decoration: none;cursor:pointer;'})),n.querySelectorAll(".user-mention").forEach((e=>{e.style.cssText='opacity:99%; text-decoration: 0.2px underline var(--glass-border); font-family: "ADLaM Display", monospace; cursor: pointer;';const t=e.textContent.trim(),n=s.querySelectorAll(".card .profile small");for(let r of n)if(t===r.textContent.trim()){e.onclick=()=>{r.parentElement.click()};break}})))})),d.querySelectorAll(".card").forEach((e=>{const t=e.querySelector(".product-img h3");t.style.cursor="pointer",t.onclick=()=>{document.querySelector(".search-loader").style.display="flex",setTimeout((()=>{const t=e.dataset.id,n=e.querySelector(".product-describe strong").textContent,r=parseFloat(e.querySelector(".amount").dataset.price),o=e.dataset.filePath;cart.push({id:t,title:n,price:r,filePath:o}),updateCartUI(),document.querySelector(".search-loader").style.display="none",cAlert("Added to cart","success","successfully")}),800)}})),document.querySelectorAll(".card .profile").forEach((e=>{e.addEventListener("click",(async t=>{document.querySelector(".search-loader").style.display="flex";const n=e.closest(".card").dataset.profileId;try{const{data:t,error:r}=await supabase.from("profiles").select("username, full_name, photo_url, bio, skills, status, created_at, portfolio_url").eq("id",n).single();if(r)throw r;const{data:o,error:s}=await supabase.from("posts").select("id, sales, star").eq("user_id",n),i=o?.length||0,a=o?.reduce(((e,t)=>e+(t.sales||0)),0)||0,l=o?.map((e=>e.id))||[];let c="N/A";if(l.length>0){const{data:e,error:t}=await supabase.from("stars").select("post_id").in("post_id",l);e&&e.length>0&&(c=formatCount(e.length))}const d=t.full_name||t.username;let p=t.bio||"No bio available";const m=t.photo_url||"/assets/images/default.png",u=new Date(t.created_at).toLocaleDateString("en-US",{month:"short",year:"numeric"});document.getElementById("popupName").textContent=d,document.getElementById("popupUsername").textContent=`@${t.username}`,document.getElementById("popupBio").innerHTML=p,document.getElementById("popupImg").src=m||"";const g=document.getElementById("userStatus");"verified"===t.status?(g.classList.add("verified"),g.title="Verified Creator"):(g.classList.remove("verified"),g.title="Active"),document.getElementById("userPosts").textContent=i,document.getElementById("userSales").textContent=formatCount(a),document.getElementById("userRating").textContent=formatCount(c)||"N/A",document.getElementById("joinedText").textContent=`Joined ${u}`,t.skills?(document.getElementById("userSkills").style.display="flex",document.getElementById("skillsText").textContent=t.skills||"creator"):document.getElementById("userSkills").style.display="none",t.portfolio_url?(document.getElementById("userWebsite").style.display="flex",document.getElementById("websiteLink").href=t.portfolio_url):document.getElementById("userWebsite").style.display="none",document.getElementById("schUser").href=`#search?q=@${encodeURIComponent(t.username)}`,document.getElementById("userToRe").value=`User reported: ${d} (@${t.username}) targeted postâ€”{${decodeURIComponent(e.name||"")}}`,document.getElementById("userView").style.display="flex"}catch(e){console.error("Error fetching live profile:",e),cAlert("Error loading profile","error","Error")}finally{document.querySelector(".search-loader").style.display="none"}}))}));if(document.querySelectorAll("h4[data-view*='/']").forEach((e=>{e.addEventListener("click",(t=>{const n=e.dataset.view||"/assets/images/20250918_223801.png",r=document.querySelector(".video-view"),o=r.querySelector("embed")||r.querySelector(".video");o.src=n,r.style.display="block",o.style.display="none",document.getElementById("embedLoader").style.display="block",o.onload=function(){document.getElementById("embedLoader").style.display="none",o.style.display="block"}}))})),n){processSearchFromURL();const e=document.querySelector(".hero form input").value.trim();e&&filterCrips(e.toUpperCase())}}catch(e){console.error("Error loading posts:",e)}}inform.className="inform",inform.innerHTML='<small style="color:#d00;max-width:80%;overlay:auto;">Note: don\'t close or reload the browser when making the payment â€” <a href="/terms/index.html#payment-refunds-heading">More info</a></b></small>',checkoutBtn.onclick=async function(){if(0===cart.length)return void cAlert("Cart is empty");const e=checkoutBtn.textContent;checkoutBtn.disabled=!0,checkoutBtn.textContent="Processing...";try{const t=await getUser();let n=t?.email;if(!n){if(n=prompt("Enter your email to continue:"),!n)return resetCheckoutButton(checkoutBtn,e),void cAlert("Email is required for payment","warning");if(!n.includes("@")||!n.includes("."))return resetCheckoutButton(checkoutBtn,e),void cAlert("Please enter a valid email address","warning")}console.log("Sending checkout request:",{email:n,cart:cart});const r=await fetch("/.netlify/functions/create-pay",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,cart:cart.map((e=>({id:e.id,title:e.title,price:+e.price,sellerId:e.sellerId,filePath:e.filePath,sales:+e.sales||0})))})}),o=await r.text();let s;console.log("DEBUG raw server response:",o);try{s=JSON.parse(o)}catch(e){throw new Error("Invalid server response: not JSON")}if(console.log("Parsed checkout response:",s),!r.ok||s.error)throw new Error(s.error||"Payment initialization failed");if(!s.authorization_url)throw new Error("No payment URL received from server");const i=100*cart.reduce(((e,t)=>e+t.price),0),a=function(t){console.log("Paystack callback triggered:",t),resetCheckoutButton(checkoutBtn,e),handlePaymentVerification(t.reference)},l=function(){console.log("Payment window closed"),resetCheckoutButton(checkoutBtn,e),cAlert("Payment window closed. You can complete the payment later.")};PaystackPop.setup({key:"pk_live_0b0770be1e29f5e7a159b39d2d9bdc2c41785306",email:n,amount:i,currency:"NGN",ref:s.reference,callback:a,onClose:l}).openIframe()}catch(t){console.error("Checkout error:",t),cAlert("Checkout failed: "+t.message,"warning"),resetCheckoutButton(checkoutBtn,e)}},document.addEventListener("DOMContentLoaded",(()=>{const e=new URLSearchParams(window.location.search).get("reference");e&&verifyPaymentOnReturn(e),loadPosts()})),document.addEventListener("DOMContentLoaded",(()=>{loadPosts("id",!1),document.querySelector(".top-list .list-item.all").addEventListener("click",(async e=>{document.querySelector(".product").innerHTML=skeletonPage,loadPosts("id",!1)})),document.querySelector(".top-list .list-item.latest").addEventListener("click",(async e=>{document.querySelector(".product").innerHTML=skeletonPage,loadPosts("created_at",!1)})),document.querySelector(".top-list .list-item.popular").addEventListener("click",(async e=>{document.querySelector(".product").innerHTML=skeletonPage,loadPosts("sales",!1)}));const e=new URLSearchParams(window.location.search).get("tap");e&&("newest"===e?document.querySelector(".top-list .list-item.latest").click():"popular"===e?document.querySelector(".top-list .list-item.popular").click():document.querySelector(".top-list .list-item.all").click())}));
